
drop table if exists st;
create table st as select * from values ('ram','ram@xyz.com') as (name,email);


1.NORMAL VIEW

drop view if exists st_view;
create view st_view as select upper(name),email from st;

select * from st_view;

insert into st values ('shyam','shyam@xyz.com');

select * from st_view;


2. TEMPORARY VIEWS:

create temp view st_tmp_view as select upper(name) from st;

select * from st_tmp_view;


3.materialized view 

drop materialized view  if exists st_mt_view;
create materialized view st_mt_view as select upper(name) as uname,email from st;


select * from st_mt_view;


insert into st values ('shyam','shyam@xyz.com');

refresh materialized view st_mt_view;
select * from st_mt_view;

------------

--dyn vw

create view mail_redacted_vw1 as
select
  'upper(name)' as name,
  case
    when 'hr_user@xyz.com' = 'hr_user@xyz.com' then email
    else regexp_extract(email, '^.*@(.*)$', 1) 
  end as mail
  from st_view;

select * from mail_redacted_vw1;
